function onGetData(e){$("#listView").html(e.html);$("#listView").show("clip",{},500).css("overflow","visible");$("#ctxInfoRecords").html(e.outputRows);$("#ctxInfoDate").html(e.outputDate);$("#infobar").show();$("#actionbar").show();$("#ctxStatus").hide();$("#ctxDataTable tbody tr .clickToEdit").click(onRowClick);$("#ctxPrevPage").prop("disabled",e.firstPage).toggleClass("disabled",e.firstPage);$("#ctxNextPage").prop("disabled",e.lastPage).toggleClass("disabled",e.lastPage)}function onEdit(e){$("#editView").html(e);$("#editView").show("clip",{},500).css("overflow","visible");$("#ctxCancelEdit").click(onCancelClick);$(".ctxInput").change(onInputChange);$("#ctxSave").click(onSaveClick);$("#ctxStatus").hide()}function onRowClick(){$("#ctxStatus").show();$("#infobar").hide();$("#actionbar").hide();$("#listView").hide();var e=$(this).closest("tr").find(".column_id").html();google.script.run.withFailureHandler(handleError).withSuccessHandler(onEdit).edit(e)}function onCancelClick(){checkChanges(cancelEdit)}function onInputChange(){$(this).addClass("ctxInputChanged")}function onSaveClick(){var e={};$(".ctxMandatory").each(function(e,t){$(t).toggleClass("ctxInputError",$(t).val().length===0)});if($(".ctxInputError").length>0){showAlert("Verplichte velden moeten ingevuld worden.");return}$(".ctxInputChanged").each(function(t,n){e[$(n).attr("name")]=$(n).val()});google.script.run.withFailureHandler(handleError).withSuccessHandler(getData).saveRecord($("#ctxRecordId").val(),e)}function onSearchKeyup(e){if(e.keyCode==13){checkChanges(load)}}function onNavClick(){var e=$(this).val()==">"?1:-1;navigatePages(e)}function onCreateClick(){$("#ctxStatus").show();$("#infobar").hide();$("#actionbar").hide();$("#listView").hide();google.script.run.withFailureHandler(handleError).withSuccessHandler(onEdit).edit(-1)}function onDeleteClick(){if($(".ctxSelectCheckBox:checked").length===0){showAlert("Geen rijen geselecteerd.");return}showDialog("Selectie verwijderen","Wilt u de geselecteerde rijen verwijderen?",deleteRecords)}function onRefreshClick(){checkChanges(reload)}function onTitleClick(){checkChanges(load)}function cancelEdit(){$("#editView").html("").hide();$("#listView").show("clip",{},500).css("overflow","visible");$("#infobar").show();$("#actionbar").show()}function checkChanges(e){if($(".ctxInputChanged").length>0){showDialog("Wijzigingen annuleren","Wilt u de wijzigingen ongedaan maken zonder te bewaren?",e)}else{e()}}function showAlert(e){$("#ctxAlert").html("<span>"+e+"</span>").show().delay(5e3).fadeOut()}function showDialog(e,t,n){$("#dialog-message").attr("title",e).html("<p>"+t+"</p>").dialog({modal:true,buttons:{Ja:function(){$(this).dialog("close");n()},Nee:function(){$(this).dialog("close")}},open:function(){$(this).parents(".ui-dialog").find(".ui-dialog-buttonpane button:eq(1)").focus();$(this).parents(".ui-dialog").find(".ui-dialog-buttonpane button:eq(0)").blur()}})}function handleError(e){showAlert(e);$("#ctxStatus").hide()}function getFilterValues(){var e=[];$(".ctxFilterSelect").each(function(t,n){e.push($(n).find("option:selected").val())});$(".ctxFilterCheck").each(function(t,n){e.push($(n).is(":checked")?$(n).val():"%")});return e}function getOrderBy(){var e={sortColumn:$("#ctxSort").find("option:selected").val(),sortOrder:$("#ctxSortOrder").is(":checked")?"asc":"desc"};return e}function getData(){$("#ctxStatus").show();$("#listView").hide();$("#infobar").hide();$("#editView").html("").hide();google.script.run.withFailureHandler(handleError).withSuccessHandler(onGetData).getData(getFilterValues(),$("#ctxSearch").val(),getOrderBy(),$("#ctxPageId").val())}function load(){$("#ctxPageId").val("1");getData()}function reload(){getData()}function initFilters(){$(".ctxFilter").change(function(){checkChanges(load)})}function initSorters(){$(".ctxSorter").change(function(){checkChanges(load)})}function deleteRecords(){$("#ctxStatus").show();var e=[];$(".ctxSelectCheckBox").each(function(t,n){if($(n).is(":checked")){e.push($(n).closest("tr").find(".column_id").html())}});google.script.run.withFailureHandler(handleError).withSuccessHandler(getData).deleteRecords(e)}function navigatePages(e){var t=parseInt($("#ctxPageId").val())+e;$("#ctxPageId").val(t);getData()}$(document).ready(function(){getData();initFilters();initSorters();$("#ctxSearch").keyup(onSearchKeyup);$("#ctxPrevPage").click(onNavClick);$("#ctxNextPage").click(onNavClick);$("#ctxRefresh").click(onRefreshClick);$("#titlebar").click(onTitleClick);$("#ctxCreate").click(onCreateClick);$("#ctxDelete").click(onDeleteClick)})